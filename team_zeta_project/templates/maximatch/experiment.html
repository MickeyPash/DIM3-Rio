{% extends 'maximatch/base.html' %}

{% load maximatch_extras %}

{% block title %}{{ experiment_title }}{% endblock %}

{% block body_block %}

    <div class="page-header">
      <h1>{{ experiment_title }}</h1>
    </div>

    {% if experiment %}
            <div>
                <span class="glyphicon glyphicon-time" title="Duration">{{ experiment.duration }}</span>
                <span class="glyphicon glyphicon-gbp" title="Payment">{{ experiment.payment_cash }}</span>
                <span class="glyphicon glyphicon-pushpin" title="Status">{{ experiment.status }}</span>
                <span class="glyphicon glyphicon-user" title="Participants">
                    {{ experiment.num_participants }} / {{ experiment.experiment.participants_needed }}
                </span>
            </div>
            <p><strong>Location: </strong>
                <a href="http://maps.google.com/maps?q={{ experiment.location }}" target="_blank">
                    {{ experiment.location }}
                </a>
            </p>
            <p><strong>{{ experiment.description }}</strong></p>

            {% if user.id|is_researcher %}
            <p><strong>Researcher:</strong> {{ experiment.researcher.user.first_name}}</p>
            <p><strong>Published on: </strong>{{ experiment.published }}</p>
            <p><strong>Start date: </strong>{{ experiment.start_date }}</p>
            <p><strong>End date: </strong>{{ experiment.end_date }}</p>
            {% endif %}

        {% if user.id|is_researcher %}
            <a href="/view_participants/{{ experiment.url }}" class="no-style">
                <button type="button" class="btn btn-default">View Participants</button>
            </a>
            {% if user.id == experiment.researcher.user.id %}
            <a href="/edit_experiment/{{ experiment.url }}" class="no-style">
                <button type="button" class="btn btn-default">Edit</button>
            </a>
            {% endif %}
        <br><br>
        {% elif user.id and not applied %}
            <p><a class="btn btn-default" href="/apply_experiment/{{ experiment.url }}" role="button">Apply</a></p>
        {% elif user.id and applied %}
            <p><a class="btn btn-default disabled" role="button">Applied</a></p>
        {% else %}
            <p><a class="btn btn-default disabled" role="button">You must be logged in to apply</a></p>
        {% endif %}

    {% else %}
        <div class="alert alert-danger">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>    
        The specified experiment {{ experiment_title }} could not be found!
        </div>
    {% endif %}

    <p><a href="/">&laquo; Experiment list</a></p>
{% endblock %}